@if (loading) {

<mat-progress-spinner matSuffix diameter="20" mode="indeterminate">
</mat-progress-spinner>
}
<mat-chip-grid #chipGrid class="chip-list">

    @for (item of selectedItems(); track item.value) {

    <mat-chip-row [removable]="!disabled && !readonly" (removed)="remove(item.value)"
        [matTooltip]="showTooltip ? item.label : ''" matTooltipPosition="above">



        {{ item.label }}
        @if (!disabled && !readonly) {

        <button matChipRemove aria-label="Remove {{item.label}}">
            <mat-icon>cancel</mat-icon>
        </button>
        }

    </mat-chip-row>
    }

    <input type="text" matInput [formControl]="searchControl" [matAutocomplete]="auto" (keydown)="onKeyDown($event)"
        [placeholder]="placeholder" />

</mat-chip-grid>


<mat-autocomplete #auto="matAutocomplete" (optionSelected)="selectOption($event.option.value)"
    class="autocomplete-large-panel" [displayWith]="displayLabel">

    @if (!readonly && !disabled && (enableSelectAll || control.value.length > 0)) {
    <mat-option>
        <div style="display: flex; gap: 10px; align-items: center; justify-content: center;  ">

            @if (enableSelectAll) {
            <div>
                <button mat-icon-button (click)="selectAll()" [matTooltip]="selectAllLabel">
                    <mat-icon>select_all</mat-icon>
                </button>
            </div>

            }
            @if (control.value.length > 0) {
            <div>

                <button mat-icon-button (click)="clearAll()" [matTooltip]="clearAllLabel">
                    <mat-icon>clear_all</mat-icon>
                </button>
            </div>
            }
        </div>
    </mat-option>
    }

    @for (option of filteredOptions(); track $index) {
    <mat-option [value]="option">
        {{ option[1] }}
    </mat-option>
    }
</mat-autocomplete>